# P2.2 - Sc√©narios de test

## Pr√©requis
1. Docker containers up : `docker-compose up -d`
2. Acc√©der √† http://localhost:3000
3. Naviguer vers le g√©n√©rateur d'exercices

## Test 1: Badge Premium visible (FREE + chapitre mixte)

### Setup
- Mode: Utilisateur FREE (pas de session token Pro)
- D√©connexion si connect√© Pro

### Actions
1. S√©lectionner un chapitre qui a des g√©n√©rateurs premium (ex: 6e_GM07, 6e_GM08)
2. Difficult√©: Moyen
3. G√©n√©rer 3 exercices
4. Attendre la g√©n√©ration compl√®te

### V√©rification
- [ ] Les exercices s'affichent correctement
- [ ] Pour les exercices FREE (is_premium: false), chercher :
  - [ ] Badge üíé "Version Premium disponible" visible
  - [ ] Texte hint pr√©sent sous le badge
  - [ ] Bouton "D√©bloquer en Pro" visible
  - [ ] Design violet/indigo non-intrusif
- [ ] Console : √©v√©nement `premium_badge_viewed` √©mis

### Clic sur CTA
1. Cliquer sur "D√©bloquer en Pro"

### V√©rification
- [ ] Modal s'ouvre (pas de redirect)
- [ ] Titre: "Aller plus loin avec Le Ma√Ætre Mot Pro"
- [ ] 3 bullets visibles:
  - Variantes A/B/C
  - Exports PDF illimit√©s
  - Templates & branding
- [ ] 2 boutons: "Essayer Pro (7 jours)" et "Continuer en version gratuite"
- [ ] Console : √©v√©nement `premium_cta_clicked` √©mis

### Clic "Essayer Pro"
1. Cliquer sur "Essayer Pro (7 jours)"

### V√©rification
- [ ] Toast de confirmation affich√©
- [ ] Modal se ferme
- [ ] Console : √©v√©nement `premium_trial_started` √©mis

---

## Test 2: Badge NON visible (FREE + chapitre 100% free)

### Setup
- Mode: Utilisateur FREE

### Actions
1. S√©lectionner un chapitre 100% gratuit (aucun g√©n√©rateur premium)
2. G√©n√©rer 3 exercices

### V√©rification
- [ ] Les exercices s'affichent correctement
- [ ] **AUCUN** badge Premium visible
- [ ] **AUCUN** bouton "D√©bloquer en Pro"
- [ ] G√©n√©ration fonctionne normalement

---

## Test 3: Badge NON visible (PRO)

### Setup
- Mode: Utilisateur PRO
- Se connecter avec un compte Pro (si disponible) ou simuler :
  ```javascript
  localStorage.setItem('lemaitremot_session_token', 'fake-token');
  localStorage.setItem('lemaitremot_user_email', 'pro@test.com');
  localStorage.setItem('lemaitremot_login_method', 'session');
  // Recharger la page
  ```

### Actions
1. V√©rifier le badge "‚≠ê PRO" dans le header
2. S√©lectionner n'importe quel chapitre (mixte ou pas)
3. G√©n√©rer 3 exercices

### V√©rification
- [ ] Les exercices s'affichent correctement
- [ ] Badge "‚≠ê PREMIUM" sur les exercices premium
- [ ] **AUCUN** badge "Version Premium disponible" (d√©j√† Pro)
- [ ] **AUCUN** CTA "D√©bloquer en Pro"
- [ ] G√©n√©ration fonctionne normalement

---

## Test 4: V√©rification code (pas de hardcode)

### Actions
1. Ouvrir `frontend/src/components/ExerciseGeneratorPage.js`
2. Chercher la section avec le badge Premium (ligne ~1238)

### V√©rification
- [ ] Condition bas√©e sur `exercise.metadata?.premium_available`
- [ ] Condition bas√©e sur `!exercise.metadata?.is_premium`
- [ ] Condition bas√©e sur `!isPro`
- [ ] **AUCUN** switch/case sur `generator_key`
- [ ] **AUCUN** hardcode de chapitres sp√©cifiques
- [ ] Texte bas√© sur `exercise.metadata?.hint`

---

## Test 5: Aucune r√©gression

### Actions
1. G√©n√©rer des exercices dans plusieurs chapitres diff√©rents
2. Varier la difficult√©
3. Tester les modes Simple et Standard

### V√©rification
- [ ] Tous les exercices se g√©n√®rent sans erreur
- [ ] Les √©nonc√©s s'affichent correctement
- [ ] Les solutions s'affichent correctement (collapsible)
- [ ] Les figures SVG s'affichent si pr√©sentes
- [ ] Les badges existants (PREMIUM, difficult√©, etc.) fonctionnent
- [ ] Aucune erreur console (sauf tracking)

---

## Test 6: Tracking events

### Actions
1. Ouvrir la console navigateur
2. Effectuer Test 1 complet (g√©n√©ration + clic CTA + essai)

### V√©rification console
```
üéØ Premium Event: premium_badge_viewed {...metadata...}
üéØ Premium Event: premium_cta_clicked
üéØ Premium Event: premium_trial_started
```

- [ ] 3 √©v√©nements √©mis au bon moment
- [ ] Metadata contient exercise_id, generator_key

---

## Checklist finale

### UX
- [ ] Aucun popup automatique
- [ ] Aucun blocage de g√©n√©ration
- [ ] Badge affich√© APR√àS g√©n√©ration uniquement
- [ ] Design discret et √©l√©gant (gradient violet)
- [ ] Modal ferme sans forcer l'action

### Fonctionnel
- [ ] Badge visible : FREE + premium_available + !is_premium
- [ ] Badge cach√© : PRO ou !premium_available ou is_premium
- [ ] Modal s'ouvre au clic CTA
- [ ] Tracking fonctionne (console.log)

### Code
- [ ] Pas de hardcode de g√©n√©rateurs
- [ ] Bas√© uniquement sur metadata API
- [ ] Composants UI r√©utilis√©s (shadcn)
- [ ] Aucune erreur linter

---

**Status**: Pr√™t pour tests manuels
**Date**: 2025-12-23







